## 应用层

> 通过解决应用进程的交互来实现特定网络应用的问题
>
> 应用层是计算机网络体系结构的最顶层，是设计和建立计算机网络的最终目的。同时也享受底层的所有功能

## 1. 客户/服务器方式（C/S）

- **客户/服务器**

  > 是指通信中所涉及的两个应用进程

  - 描述的是进程之间服务和被服务的关系
  - **客户是服务请求放，服务器是服务提供方**
  - 服务器总是**处于运行等待状态，等待客户的服务请求。**服务器具有固定端口号（例如：HTTP服务器的默认端口号为80），而运行服务器的主机也具有固定的IP地址

- 基于（C/S）方式的应用服务通常是**服务集中型**的

  - 因为一台服务器要为多个客户机提供服务，**常会出现服务器跟不上众多客户机请求的情况**，因此，通常用**计算机群集（服务器场）**构建一个强大的虚拟服务器

## 2. 对等方式（P2P方式）

<img src="https://s2.loli.net/2022/03/29/7W2U8hXDJTQycnk.png" alt="image-20210408111938739" style="zoom:50%;" />

## 3. 动态主机配置协议DHCP

> 通过DHCP服务器为指定网段主机分配IP地址

<img src="https://s2.loli.net/2022/03/29/1IsVUaBpoScNlew.png" alt="image-20210408113125059" style="zoom:50%;" />

**流程：**

1. **DHCP发现消息：**DHCP客户机广播寻找DHCP服务器（**DHCP发现消息**），源地址（0.0.0.0），目的地址（广播地址255.255.255.255）
2. **DHCP提供消息：**DHCP服务器收到后，返回**DHCP提供消息**，包含提供给DHCP客户机的IP地址和相关配置信息。原地址（DHCP服务器地址），目的地址（广播地址**还未分配IP地址**）
3. **DHCP请求：**客户机以收到的第一个**DHCP消息为准**，发送**DHCP请求**，来请求分配IP地址，源地址（0.0.0.0），目的地址（广播地址255.255.255.255）
4. **确认IP地址：**DHCP收到请求信息后，查看其中**事务ID**是否相符，然后再次**使用ARP确认IP地址没有被使用，确认成功后将此IP地址应用（有租约时长）**
5. **续约：**当IP地址租约达到0.5倍时间时，客户机再次向DHCP服务器发送请求信息：
   1. **续约：**收到请求，返回**确认报文**，
   2. **不续约：**收到请求，返回**否认报文**。（立即停止使用，并重新发送**DHCP发现消息**）
   3. **无响应：**在租期达到0.875倍是，必须重新发送**DHCP请求**报文，若最后还无响应，就停用，重新发送**DHCP发现消息**
6. **释放报文：**客户端可以随时终止DHCP服务器提供的租用期，发送释放报文，源地址（0.0.0.0），目的地址（255.255.255.255）

## 3. 域名系统DNS

> 将网址转换成对应的IP地址

**使用层次结构的命名树**

> 要确保稳定性，不会把DNS存放在一台机子上。DNS是分布式系统，具有稳定性
>
> **DNS使大多数域名都在本地解析**，仅少量解析需要在因特网上通信。

<img src="https://s2.loli.net/2022/03/29/95erbkyKc7ATPIJ.png" alt="image-20210408125953774" style="zoom:50%;" />

<img src="https://s2.loli.net/2022/03/29/LhYUbSvtcBK5DjP.png" alt="image-20210408130151667" style="zoom:50%;" />

<img src="https://s2.loli.net/2022/03/29/gy8YQpdk3HFXOso.png" alt="image-20210408130609042" style="zoom:50%;" />

<img src="https://s2.loli.net/2022/03/29/J6deTzqcCB8Gi13.png" alt="image-20210408130942485" style="zoom:50%;" />

<img src="https://s2.loli.net/2022/03/29/bfzOvwR2DCB49aj.png" alt="image-20210408131224716" style="zoom:50%;" />

## 4. 文件传送协议FTP

> 将计算机中的文件传送给另一台计算机

FTP常用在计算机之间传输文件，尤其是**批量传输文件**

另一个用途：**让网站设计者将构成网站内容的大量文件批量上传到他们的Web服务器**

- **提供交互式的访问**，指明文件类型与格式（Ascall码），**允许文件具有存取权限（访问文件的用户必须经过授权，输入有效口令）**
- 屏蔽了个系统的细节，适合在易购网络中传送

<img src="https://s2.loli.net/2022/03/29/eAuwnULDTEMxgZ4.png" alt="image-20210408132633263" style="zoom:50%;" />

- **传送控制命令一直开启**
- **传输数据在传送时开启，结束后就关闭**

## 5. 电子邮件

> 三个主要构件：**用户代理、邮件服务器，电子邮件所需的协议**

1. **用户代理：**用户与电子邮件系统的接口
2. **邮件服务器：**电子邮件系统的基础设施，**发送和接收邮件，同时还要负责维护用户的邮箱**，所有的ISP都有邮件服务器
3. **协议：**邮件发送协议（**SMTP**）和读取协议（POP3，IMAP）

<img src="https://s2.loli.net/2022/03/29/OkCvHou7tTa84Lf.png" alt="image-20210408135731725" style="zoom:50%;" />

### 简单邮件传送协议SMTP

<img src="https://s2.loli.net/2022/03/29/Ym5r3ceuVtPkOHx.png" alt="image-20210408140138068" style="zoom:50%;" />

<img src="https://s2.loli.net/2022/03/29/i7524oIzgljmbPX.png" alt="image-20210408140627485" style="zoom:50%;" />

### 邮件读取协议

<img src="https://s2.loli.net/2022/03/29/8oLFvpaxhTKGben.png" alt="image-20210408141037794" style="zoom:50%;" />

### 基于万维网的电子邮件

<img src="https://s2.loli.net/2022/03/29/qNcHz7PdOEGfv8S.png" alt="image-20210408141245646" style="zoom:50%;" />

## 6. 万维网

> 一个大规模的、联机式的信息储藏所，是运行在因特网上的一个分布式应用
>
> 利用网页之间的超链接将不同网站的网页连接成一张逻辑上的信息网

浏览器最重要的部分是**渲染引擎，也就是浏览器内核**。负责对网页内容进行解析和显示

- 不同内核渲染也不一样

- 为了方便地访问在世界范围的文档，万维网使用同一资源定位符URL来指明因特网任何种类“资源”的位置，由以下四个部分组成

  <img src="https://s2.loli.net/2022/03/29/1LuWqngmTpflzbH.png" alt="image-20210408142436226" style="zoom:50%;" />

### 超文本传输协议HTTP

> 定义了浏览器怎样想万维网服务器请求万维网文档，以及万维网服务器怎么把文档传送给浏览器

<img src="https://s2.loli.net/2022/03/29/QqF49iTokz3Whlv.png" alt="image-20210408143241131" style="zoom:50%;" />

<img src="https://s2.loli.net/2022/03/29/HuyQ2K3wxLvafXA.png" alt="image-20210408143346180" style="zoom:50%;" />

### HTTP请求报文

<img src="https://s2.loli.net/2022/03/29/16rlTM2PmhceS9d.png" alt="image-20210408143628206" style="zoom:50%;" />

### HTTP响应报文

<img src="https://s2.loli.net/2022/03/29/6NBf7SMgRbXITyh.png" alt="image-20210408143853025" style="zoom:50%;" />

### Cookie

> Cookie提供了一种机制使得万维网服务器能够**主动**“记住用户”，**Cookie是一种对无状态的HTTP进行状态化的技术**

<img src="https://s2.loli.net/2022/03/29/u6h9QdLExUcNveT.png" alt="image-20210408144300317" style="zoom:50%;" />

### 万维网缓冲与代理服务器

<img src="https://s2.loli.net/2022/03/29/3R4PdoJpmjgChfr.png" alt="image-20210408144741774" style="zoom:50%;" />

**保证原始服务器的内容在修改后本地的缓冲能及时更新**

> 原始服务器为每个响应对象设定一个**修改时间字段**和一个**有效日期字段**
>
> 1. 请求发送到代理服务器，文档未过期则直接返回响应报文，否则重新发送请求到原始服务器
> 2. 发送的请求中有**if-modified-since字段，记录了上次文档的修改时间**，如果一致则返回空文档

<img src="https://s2.loli.net/2022/03/29/WvgZukwHM62BTCX.png" alt="image-20210408150502393" style="zoom:50%;" />