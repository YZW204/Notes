# shell 编程

> 文件开头:
>
> #!/bin/bash
>
> 以.sh结尾的文件就是 shell 文件

## 一、变量

- 同其他语言的变量一样，不能以数字开头

- 变量规范是全部以大写字母为变量

- 赋值的时候左右不能有空格

  ```shell
  定义并赋值
  A=10
  ```

- 撤销变量

  ```shell
  unset A
  ```

- 将命令的返回值赋值给变量

  ```shell
  A=`date`
  A=$(date)
  会运行其中的命令，然后再赋值
  ```

### 环境变量

```shell
export 变量名=变量值	设置一个环境变量
source 配置文件		 重新加载配置文件
echo $变量名		  输出变量
```

- 多行注释

```shell
:<<!
内容
!
```

### 位置参数

> 执行脚本的时候附带的参数信息，如 `./myshell.sh 10 20`,表示携带了10和20两个参数

语法

```sh
$n 获取某个参数直接用数字，$1。10以上的用${10}
$*	获取所有参数，把参数看成一个整体
S@	获取所有参数，把参数看成一个个体
S#	获取参数个数
```

### 预定义变量

> shell 设计者事先已经定义好的变量，可以直接在shell 中使用

```sh
$$	当前进程的进程号
$!	后台运行最后一个进程的进程号
$?	最后一次执行的命令的返回状态；
	0：正确
  非0：不正确
```

### 运算符

```shell
1. $((运算式))		需要两个括号包裹
2. $[运算式]		需要一个方括号包裹
3. expr n + m 	  符号之间需要空格开
	\* ,/,% 	  3的乘法有区别
```

### 判断

> 条件为空就是假

```shell
if [ condition ]	中括号左右都需要有空格
then 
	语句
elif [ condition ]
then 
	语句
fi
```

- case

```shell
case $变量 in
"值1")
语句
;;
"值2")
语句
;;
*)		其他
语句
;;
esac
```

### 循环

- for

```shell
1：
for 变量	in 值1 值2
do
语句
done

2：
for ((初始值;条件；变量变化))	和其他语言一样
do
语句
done
```

- while

```shell
while [ condition ]
do
语句
done
```

### 控制台

> 与控制台的一些交互

```shell
read (选项) (参数)
-p：会输出的提示
-t：限定时间，超过则无法再次输入

例子：
read -p "请输出NUM1=" NUM1
会读取控制台，并把值赋给NUM1
```

## 二、函数

### 系统函数

```shell
获取文件名：
basename [pathname]	[suffix] 可以获取路径的文件名
如果有suffix 后缀，那么文件的后缀也会被去掉

获取路径名：
dirname 路径名
返回文件的路径，只到目录

```

### 自定义函数

```shell
[function] funname [()]{

	Action;
	[return int;]
}

调用：	function [值]
```

例子：

